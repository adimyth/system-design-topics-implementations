## Spatial Indexing
Spatial Indexing is a collection of algorithms that allow us to effeciently represent a location on Earth without actually having to store the coordinates. This is useful when we have a large number of locations and we want to quickly find the locations that are close to a given point. Some of the most popular spatial indexing algorithms are:
- Quadtree
- R-tree
- Geohash
- K-d tree


## Geohashing
A geohash is a string of characters that represents a location on the Earth's surface. It is generated by encoding the latitude and longitude of the location into a binary string and then converting it into a base32 string.

A geohash can have up to 12 characters, with each character representing a different level of precision. The longer the geohash, the more precise the location it represents.

This works by dividing the world into a grid of cells, each of which is represented by a geohash. The geohash is then used as a key in a spatial index to retrieve data based on their spatial location.

| Precision | Width     | Height    | Area            |
| --------- | --------- | --------- | --------------- |
| 1         | 5,009.4km | 4,992.6km | 24,999,511.8km² |
| 2         | 1,252.3km | 624.1km   | 781,250.9km²    |
| 3         | 156.5km   | 156.0km   | 24,414.8km²     |
| 4         | 39.1km    | 19.5km    | 764.5km²        |
| 5         | 4.9km     | 4.9km     | 24.2km²         |
| 6         | 1.2km     | 609.4m    | 3.0km²          |
| 7         | 152.9m    | 152.4m    | 0.02km²         |
| 8         | 38.2m     | 19.1m     | 0.38km²         |
| 9         | 4.8m      | 4.8m      | 0.02km²         |
| 10        | 1.2m      | 0.6m      | 0.003km²        |
| 11        | 150mm     | 150mm     | 0.00002km²      |
| 12        | 37mm      | 18.6mm    | 0.0000002km²    |

Play with it at https://geohash.softeng.co/

The geohash for my location upto 4 characters is `te7u`.

> Note: Geohashes rely on Hilbert's curve to divide the world into a grid of cells. This is a space-filling curve that can be used to map a multi-dimensional space into a one-dimensional space. This allows us to represent a location on the Earth's surface as a single number, which can then be converted into a geohash.

### Benefits of Geohashing
- Compact representation of location: database can store geohashes instead of coordinates
- Shared prefix indicates proximity: similar locations will have similar geohashes, substrings of the geohash can be used to find nearby locations
- Databases are optimized for string lookups: geohashes can be used as keys in a spatial index to quickly retrieve data based on their spatial location
- Finding nearby locations is a common use case: geohashes make it easy to find locations that are close to a given point without having to compute the distance between each pair of locations. Example - if you want to find location within 1km of a given point, you can find all geohashes that share the first 5 characters with the geohash of the given point. 
    ```sql
    SELECT
        substring(geohash, 1, 6) AS prefix
    FROM
        locations
    WHERE
        geohash = 'sx8dfsy'
    ```

## Implementing Geohashing
1. Refer to `geohashing.py` for a simple implementation of geohashing in Python. This takes in coordinates and converts them into a geohash string.
2. Refer to `reverse_geohashing.py` for a simple implementation of reverse geohashing in Python. This takes in a geohash string and converts it into coordinates.

## Limitations
1. Geohashes are not perfect: they are an approximation of a location and can be off by a few meters. This is because the Earth is not a perfect sphere and the geohash algorithm does not take into account the curvature of the Earth.
2. Grid Errors: Adjacent locations in real world may not be adjacent in the geohash grid.

## References
1. [Hilbert's Curve: Is infinite math useful?](https://www.youtube.com/watch?v=3s7h2MHQtxc)
2. [Geohash: the algorithm inside and out - Part 1](https://www.youtube.com/watch?v=vGKs-c1nQYU)